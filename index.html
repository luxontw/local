<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Bridge Scanner</title>
    <style>
        body { font-family: monospace; padding: 15px; background: #222; color: #0f0; }
        h1 { border-bottom: 1px solid #0f0; }
        .found { color: #ff0; font-weight: bold; font-size: 1.2em; margin: 10px 0; border: 1px solid #ff0; padding: 5px; }
        .method { margin-left: 20px; color: #0ff; }
        button { font-size: 20px; padding: 10px; width: 100%; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>系統後門掃描器</h1>
    <button onclick="scanForBridges()">開始掃描 (Scan)</button>
    <div id="log">等待掃描...</div>

    <script>
        // 這些是標準瀏覽器物件，我們要過濾掉
        const blacklist = [
            'window', 'self', 'document', 'name', 'location', 'customElements', 'history', 'locationbar', 'menubar', 'personalbar', 'scrollbars', 'statusbar', 'toolbar', 'status', 'closed', 'frames', 'length', 'top', 'opener', 'parent', 'frameElement', 'navigator', 'origin', 'external', 'screen', 'innerWidth', 'innerHeight', 'scrollX', 'pageXOffset', 'scrollY', 'pageYOffset', 'visualViewport', 'screenX', 'screenY', 'outerWidth', 'outerHeight', 'devicePixelRatio', 'clientInformation', 'screenLeft', 'screenTop', 'defaultStatus', 'defaultstatus', 'styleMedia', 'onsearch', 'isSecureContext', 'performance', 'onappinstalled', 'onbeforeinstallprompt', 'crypto', 'indexedDB', 'webkitStorageInfo', 'sessionStorage', 'localStorage', 'chrome', 'speechSynthesis', 'webkitRequestFileSystem', 'webkitResolveLocalFileSystemURL', 'openDatabase', 'applicationCache', 'caches'
        ];

        function scanForBridges() {
            var log = document.getElementById('log');
            log.innerHTML = "正在掃描 window 物件...<br>";
            
            var foundSomething = false;

            // 遍歷 window 下的所有屬性
            for (var prop in window) {
                try {
                    // 過濾掉標準屬性和事件
                    if (blacklist.indexOf(prop) === -1 && 
                        prop.indexOf('on') !== 0 && 
                        prop.indexOf('webkit') === -1 &&
                        typeof window[prop] === 'object' && 
                        window[prop] !== null) {

                        // 找到可疑物件！
                        var html = "<div class='found'>發現可疑物件: window." + prop + "</div>";
                        
                        // 嘗試列出該物件的方法
                        for (var method in window[prop]) {
                            html += "<div class='method'> -> ." + method + "()</div>";
                        }
                        
                        log.innerHTML += html;
                        foundSomething = true;
                    }
                } catch (e) {}
            }

            if (!foundSomething) {
                log.innerHTML += "<br>掃描完成，未發現明顯注入物件。<br>系統可能非常乾淨。";
            } else {
                log.innerHTML += "<br>掃描完成！請查看上方黃色項目。";
            }
        }
    </script>
</body>
</html>
